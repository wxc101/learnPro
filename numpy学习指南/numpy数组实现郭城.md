# Numpy çš„å­¦ä¹ ä½¿ç”¨æ–¹æ³•

## (2,)ä¸(2,1)çš„åŒºåˆ«

numpy.ndarray.shapæ˜¯è¿”å›ä¸€ä¸ªæ•°ç»„ç»´åº¦çš„å…ƒç»„ã€‚ (2,)ä¸(2,1)çš„åŒºåˆ«å¦‚ä¸‹ï¼š

ndarray.shapeï¼šæ•°ç»„çš„ç»´åº¦ã€‚ä¸ºä¸€ä¸ªè¡¨ç¤ºæ•°ç»„åœ¨æ¯ä¸ªç»´åº¦ä¸Šå¤§å°çš„æ•´æ•°å…ƒç»„ã€‚ä¾‹å¦‚äºŒç»´æ•°ç»„ä¸­ï¼Œè¡¨ç¤ºæ•°ç»„çš„â€œè¡Œæ•°â€å’Œâ€œåˆ—æ•°â€ã€‚
ndarray.shapeè¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œè¿™ä¸ªå…ƒç»„çš„é•¿åº¦å°±æ˜¯ç»´åº¦çš„æ•°ç›®ï¼Œå³ndimå±æ€§ã€‚
ä¸€èˆ¬æƒ…å†µä¸‹ï¼š

[1,2]çš„shapeå€¼(2,)ï¼Œæ„æ€æ˜¯ä¸€ç»´æ•°ç»„ï¼Œæ•°ç»„ä¸­æœ‰2ä¸ªå…ƒç´ ã€‚

[[1],[2]]çš„shapeå€¼æ˜¯(2,1)ï¼Œæ„æ€æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ¯è¡Œæœ‰1ä¸ªå…ƒç´ ã€‚

[[1,2]]çš„shapeå€¼æ˜¯ï¼ˆ1ï¼Œ2ï¼‰ï¼Œæ„æ€æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ¯è¡Œæœ‰2ä¸ªå…ƒç´ ã€‚

## å„ä¸ªå‡½æ•°çš„ä½¿ç”¨

### np.array

```python
import numpy as np

# å»ºç«‹ä¸€å€‹é™£åˆ— (æ•¸çµ„)
test = np.array([9, 4, 8, 7])
# å°å‡ºå‹åˆ¥
print(type(test))
print(test.shape)
print(test[0], test[1], test[2], test[3])
test[0] = 5
print(test)
# å»ºç«‹ä¸€ä¸ªäºŒç»´æ•°ç»„
npt = np.array([[6,8,9],[4,8,7]])
print(npt.shape)
print(npt[0, 0], npt[0, 1], npt[1, 0])
```

### np.ones()

### np.zeos()

### np.full()

### np.eye()

### np.empyt()

```python
import numpy as np

# å»ºç«‹å…¨ 0 é™£åˆ—
a = np.zeros((2,2))
print(a)

# å»ºç«‹å…¨ 1 é™£åˆ—
b = np.ones((1,2))
print(b)

# å»ºç«‹å…¨ 7 é™£åˆ—
# Create a constant array
c = np.full((2,2), 7)  
print(c)

# Create a 2x2 identity matrix
d = np.eye(2)
print(d)
e = np.empty(d)
print(e)

```



### dtype 

#### np.int64

#### np.float64

```
import numpy as np

x = np.array([1, 2])
print(x.dtype)

x = np.array([1.0, 2.0])
print(x.dtype)

x = np.array([1, 2], dtype=np.int64)
print(x.dtype)
```

### likeå‡½æ•°

### np.empty_like()

### np.ones_like()

np.ones_like() è¿”å›ä¸è¾“å…¥æ•°ç»„å½¢çŠ¶ç›¸åŒï¼Œä½†å…ƒç´ å…¨ä¸º 1 çš„æ•°ç»„ï¼›

### np.zeros_like()

p.ones_like() è¿”å›ä¸è¾“å…¥æ•°ç»„å½¢çŠ¶ç›¸åŒï¼Œä½†å…ƒç´ å…¨ä¸º 0çš„æ•°ç»„ï¼›

## numpyæ•°ç»„çš„è®¡ç®—å…³ç³»

### æ•°å€¼è®¡ç®—

```python
import numpy as np

x = np.array([[1,2,3], [4,5,6], [7,8,9], [10, 11, 12]])
v = np.array([1, 0, 1])
y = np.empty_like(x)

for i in range(4):
    y[i, :] = x[i, :] + v
print(y)
```

### å¹¿æ’­æœºåˆ¶

numpyä¸­ç»´åº¦çš„å¯¹åº”é¡ºåºæ˜¯å€’ç€å¯¹åº”ï¼Œä¸¤ä¸ªæ•°ç»„å€’æ•°ç¬¬ä¸€ä¸ªç»´åº¦ç›¸äº’å¯¹åº”ï¼Œæ¥ç€æ˜¯å€’æ•°ç¬¬äºŒç»´ï¼Œå¦‚æ­¤ç±»æ¨ã€‚element-wiseçš„è¿ç®—ï¼Œå½“ä¸¤ä¸ªæ•°ç»„æ€»ç»´åº¦ä¸ç›¸åŒæ—¶ï¼Œå¹¿æ’­ç•Œå®šäº†æ˜¯å¦èƒ½è¿ç®—ï¼Œèƒ½è¿ç®—çš„è¯è¯¥æŒ‰ä»€ä¹ˆè§„åˆ™è¿ç®—ï¼Œå˜æ¸…äº†è¿™ä¸ªåœºæ™¯ä¸‹çš„è®¡ç®—è§„åˆ™é—®é¢˜ã€‚

```
"""
ä¸¤ä¸ªn-dæ•°ç»„ç»´åº¦ç›¸åŒæ—¶ï¼Œelement-wiseè¿ç®—æ€ä¹ˆç®—å¾ˆæ¸…æ™°
"""
a=np.random.randint(10, size=[2,5])
b=np.random.randint(10, size=[2,5])
(a+b).shape
Out: (2, 5)

"""
å½“ä¸¤ä¸ªn-dæ•°ç»„ç»´åº¦ä¸ç›¸åŒï¼Œä½†çœ‹èµ·æ¥åˆâ€œåƒèƒ½è¿ç®—â€ï¼Œå¹¿æ’­è§„åˆ™å®šä¹‰äº†è¯¥æ€ä¹ˆè®¡ç®—
"""
c=np.random.randint(20, size=[2,2,5])
(a+c).shape
Out: (2, 2, 5)    #å¹¿æ’­å®šä¹‰äº†ç»“æœæ•°ç»„è¯¥æ€ä¹ˆç®—å‡ºæ¥
```

1ï¼‰ å‘é‡å’Œæ ‡é‡è¿ç®—ï¼Œæ ‡é‡è‡ªåŠ¨å¤åˆ¶æ‰©å……ä¸ºå‘é‡

2ï¼‰çŸ©é˜µå’Œå‘é‡è¿ç®—ï¼Œå‘é‡åœ¨æ²¡å¯¹é½çš„ç»´åº¦è‡ªåŠ¨å¤åˆ¶æ‰©å……ä¸ºçŸ©é˜µ

3ï¼‰ä¸¤ä¸ªçŸ©é˜µåœ¨ä¸¤ä¸ªç»´åº¦ä¸Šéƒ½ä¸å¯¹é½ï¼Œä¸”éƒ½èƒ½å¹¿æ’­ï¼Œåœ¨æ¯ä¸ªç»´åº¦ä¸Šåˆ†åˆ«å¤åˆ¶æ‰©å……

![image-20221102172055240](numpyæ•°ç»„å®ç°éƒ­åŸ.assets/image-20221102172055240.png)

```python

 
"""
1. element-wise è¿ç®—ï¼Œç»´åº¦å¯¹åº”å…³ç³»
bçš„ç¬¬0ç»´å’Œaçš„ç¬¬1ç»´å¯¹é½ï¼ˆç»´åº¦å€’ç€å¯¹é½ï¼‰
bé‡å¤å’Œaçš„æ¯è¡Œè¿ç®—ï¼Œè¾“å…¥ç»“æœä¸º3*2ç»´
"""
b*a
array([[  0,  20],
       [ 20,  60],
       [ 40, 100]])
 
"""
1.1 ç›¸åº”ç»´åº¦ä¸å¯¹é½ï¼Œå¹¶ä¸”é•¿åº¦éƒ½ä¸ä¸º1ï¼Œéæ³•
"""
c*a
ValueError: operands could not be broadcast together with shapes (3,) (3,2) 
 
#c = np.array([0, 1, 2])
d=np.array([[10],[20],[30]])
 
"""
1.2 ç›¸åº”ç»´åº¦å¯å¹¿æ’­
cåœ¨è¡Œæ–¹å‘å¤åˆ¶æ‰©å……ï¼Œdåœ¨åˆ—æ–¹å‘
"""
d+c
array([[10, 11, 12],
       [20, 21, 22],
       [30, 31, 32]])
 
"""
2.1 éelement-wiseè¿ç®—ï¼ŒæŒ‰è¿ç®—å®šä¹‰æ¥è®¡ç®—ï¼ŒåŸºç¡€å¯¹åº”ç»´åº¦ä¸Šä¸é€‚ç”¨å¹¿æ’­
    å¦‚æœåŸºç¡€å¯¹åº”ç»´åº¦ä¸å¯¹é½ï¼Œä¼šç›´æ¥æŠ¥é”™
"""
np.dot(d,c)  
ValueError: shapes (3,1) and (3,) not aligned: 1 (dim 1) != 3 (dim 0)
#np.dot(c,d)æ˜¯åˆæ³•çš„
 
"""
2.2 éelement-wiseè¿ç®—
    åŸºç¡€ç»´åº¦åˆæ³•å¯¹é½æ—¶ï¼Œåœ¨æ›´é«˜ç»´åº¦ä¸Šæ˜¯element-wiseå¯¹åº”çš„ï¼ˆä»¥åŸºç¡€å¯¹åº”å—ä¸ºå•ä½ï¼‰ï¼Œä¼šé€‚ç”¨å¹¿æ’­è§„åˆ™
"""
a=np.random.randint(24,size=[2,3,4])
b=np.random.randint(12,size=[4,2])
np.dot(a,b).shape    #èƒ½åˆæ³•è¿›è¡Œè¿ç®—
Out[111]: (2, 3, 2)
```

![image-20221102194612271](numpyæ•°ç»„å®ç°éƒ­åŸ.assets/image-20221102194612271.png)

**å¦‚æœæ˜¯ä¸€ç»´çš„æ•°æ®ï¼Œé‚£ä¹ˆåœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹åº”çš„ç»´åº¦ç›¸åŒï¼Œæ‰èƒ½å¤Ÿè¿›è¡Œè®¡ç®—ï¼Œå¦åˆ™çš„è¯ï¼Œå®¹æ˜“å‡ºç°é”™è¯¯**

## np.tileå‡½æ•°

Numpyçš„tile()å‡½æ•°ï¼Œå°±æ˜¯å°†åŸçŸ©é˜µæ¨ªå‘ã€çºµå‘åœ°å¤åˆ¶ã€‚tileæ˜¯ç“·ç –çš„æ„æ€ï¼Œ

é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æŠŠæ•°ç»„åƒç“·ç –ä¸€æ ·é“ºå±•å¼€æ¥

```

import numpy as np

x = np.array([[1,2,3], [4,5,6], [7,8,9], [10, 11, 12]])
v = np.array([1, 0, 1])
vv = np.tile(v, (4, 4))
print(vv)
vv = np.tile(v, 2)
print(vv)
vv = np.tile(v, (1,2))
print(vv)

"""
[[1 0 1 1 0 1 1 0 1 1 0 1]
 [1 0 1 1 0 1 1 0 1 1 0 1]
 [1 0 1 1 0 1 1 0 1 1 0 1]
 [1 0 1 1 0 1 1 0 1 1 0 1]]
[1 0 1 1 0 1]
[[1 0 1 1 0 1]]"""
```

## np.copy()

[éœ€è¦åŒºåˆ†å¯å˜æ•°æ®å’Œä¸å¯å˜æ•°æ®ç±»å‹](https://blog.csdn.net/wumingxiaoyao/article/details/122010313)

np.copy()å±äºæ·±æ‹·è´,æ‹·è´å‰çš„åœ°å€å’Œæ‹·è´åçš„åœ°å€ä¸ä¸€æ ·. è€Œ " = " å±äºæµ…æ‹·è´,æ‹·è´åçš„åœ°å€å’Œæ‹·è´å‰çš„åœ°å€ä¸€æ ·.

```python
a ={"name ":'wangxinchao',"age":19}
b = a
a["age"] = 20
print(b)
# {'name ': 'wangxinchao', 'age': 20}

x = [12,3,4,4]
y = x
x[0] = 13
print(x)
print(y)
# [13, 3, 4, 4]

# å¤±æ•ˆäº†
x = 23
y = x
print(y)
x = 23+3
print(y)
# 23
```

## npä¸­éšæœºç”Ÿæˆéšæœºæ•°

### æœ€å¸¸ç”¨çš„éšæœºç”Ÿæˆå‡½æ•°ä¸ºrand, randn, randint, choice

å®ƒä»¬åˆ†åˆ«è¡¨ç¤º0-1[å‡åŒ€åˆ†å¸ƒ](https://so.csdn.net/so/search?q=å‡åŒ€åˆ†å¸ƒ&spm=1001.2101.3001.7020)çš„éšæœºæ•°ç»„ã€æ ‡å‡†æ­£æ€çš„éšæœºæ•°ç»„ã€éšæœºæ•´æ•°ç»„å’Œéšæœºåˆ—è¡¨æŠ½æ ·ï¼š

```python
np.random.rand(3) # ç”Ÿæˆæœä»0-1å‡åŒ€åˆ†å¸ƒçš„ä¸‰ä¸ªéšæœºæ•°
np.random.rand(3, 3) # æ³¨æ„è¿™é‡Œä¼ å…¥çš„ä¸æ˜¯å…ƒç»„ï¼Œæ¯ä¸ªç»´åº¦å¤§å°åˆ†å¼€è¾“å…¥

# randnç”Ÿæˆäº†N(0,I)çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼š
np.random.randn(3)
np.random.randn(2, 2)


# randintå¯ä»¥æŒ‡å®šç”Ÿæˆéšæœºæ•´æ•°çš„æœ€å°å€¼æœ€å¤§å€¼ï¼ˆä¸åŒ…å«ï¼‰å’Œç»´åº¦å¤§å°
low, high, size = 5, 15, (2,2) # ç”Ÿæˆ5åˆ°14çš„éšæœºæ•´æ•°
np.random.randint(low, high, size)


# choiceå¯ä»¥ä»ç»™å®šçš„åˆ—è¡¨ä¸­ï¼Œä»¥ä¸€å®šæ¦‚ç‡å’Œæ–¹å¼æŠ½å–ç»“æœï¼Œå½“ä¸æŒ‡å®šæ¦‚ç‡æ—¶ä¸ºå‡åŒ€é‡‡æ ·ï¼Œé»˜è®¤æŠ½å–æ–¹å¼ä¸ºæœ‰æ”¾å›æŠ½æ ·
my_list = ['a', 'b', 'c', 'd']
np.random.choice(my_list, 2, replace=False, p=[0.1, 0.7, 0.1 ,0.1]) # replace=Falseè¡¨ç¤ºä¸å…è®¸å‡ºç°é‡å¤å…ƒç´ 
np.random.choice(my_list, (3,3)) # å½“ä¸æŒ‡å®šå‚æ•°æ—¶ï¼Œé»˜è®¤å‡åŒ€é‡‡æ ·ï¼Œå¯ä»¥å‡ºç°é‡å¤å…ƒç´ 

# å½“è¿”å›çš„å…ƒç´ ä¸ªæ•°ä¸åŸåˆ—è¡¨ç›¸åŒæ—¶ï¼Œä¸æ”¾å›æŠ½æ ·ç­‰ä»·äºä½¿ç”¨permutationå‡½æ•°ï¼Œå³æ‰“æ•£åŸåˆ—è¡¨
np.random.permutation(my_list)
```

### å¯¹äºæœä»åŒºé—´aåˆ°bä¸Šçš„å‡åŒ€åˆ†å¸ƒå¯ä»¥å¦‚ä¸‹ç”Ÿæˆï¼š

```python
#method1
a, b = 5, 15
(b - a) * np.random.rand(3) + a

#method2
np.random.uniform(5, 15, 3)

```

### å¯¹äºæœä»æ–¹å·®ä¸º ğœ2 å‡å€¼ä¸º ğœ‡ çš„ä¸€å…ƒæ­£æ€åˆ†å¸ƒå¯ä»¥å¦‚ä¸‹ç”Ÿæˆï¼š

```python
mu, sigma = 3, 2.5
mu + np.random.randn(3) * sigma

np.random.normal(3, 2.5, 3) # ç”Ÿæˆ3ä¸ªæœä»å‡å€¼ä¸º3ï¼Œæ ‡å‡†å·®ä¸º2.5çš„æ­£æ€åˆ†å¸ƒéšæœºæ•°

```

# ç»´åº¦çš„è½¬æ¢

## np.reshapeå‡½æ•°

```python
# ç”Ÿæˆä¸€ä¸ªäºŒç»´æ•°æ®
x = np.array(range(12))
x = np.reshape(x, (3,4))
print(x)
# è¾“å‡ºä¸ºï¼š
# [[ 0  1  2  3]
#  [ 4  5  6  7]
x = np.reshape(x, (4,3))
print(x)

x = np.reshape(x, (2,2,3))
print(x)
```

## åœ¨æ•°ç»„çš„æœ€åä¸€ç»´å¢åŠ ä¸€ä¸ªç»´åº¦ä¿¡æ¯

å°±æ˜¯ç›¸å½“äºåœ¨æœ€åçš„**æ•°å­—ä¸­ç»™æ·»åŠ ä¸€ä¸ª[]**

```python
# åœ¨å¤šç»´æ•°ç»„çš„æœ€åä¸€ç»´å†å¢åŠ ä¸€ä¸ªç»´åº¦
y1 = np.expand_dims(x, axis=x.ndim)
y2 = np.expand_dims(x, axis=-1)
y3 = x[:,:,np.newaxis]
y4 = np.reshape(x, (*x.shape,1))
# ä¸Šè¿°å››ç§æ–¹æ³•çš„ç»“æœå®Œå…¨ä¸€è‡´
assert(np.all(y1==y2))
assert(np.all(y2==y3))
assert(np.all(y3==y4))
print(y4)
# è¾“å‡ºä¸ºï¼š
# [[[ 0]
#   [ 1]
#   [ 2]
#   [ 3]]
 
#  [[ 4]
#   [ 5]
#   [ 6]
#   [ 7]]
 
#  [[ 8]
#   [ 9]
#   [10]
#   [11]]]
```

## å‡å°ä¸€ä¸ªç»´åº¦

å¦‚æœå¤šç»´æ•°ç»„çš„æœ€åä¸€ç»´çš„é•¿åº¦ä¸º1ï¼Œå¯ä»¥å°†è¯¥ç»´å»æ‰ï¼Œå»æ‰çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨[numpy](https://so.csdn.net/so/search?q=numpy&spm=1001.2101.3001.7020).reshapeæˆ–numpy.squeezeï¼Œç¤ºä¾‹å¦‚ä¸‹

```python
# å‡è®¾æ¬²å°†åˆšæ‰å¢åŠ ä¸€ç»´ç”Ÿæˆçš„å¤šç»´æ•°ç»„y4çš„æœ€åä¸€ç»´å»æ‰
y = y4
x1 = np.squeeze(y, axis=(y.ndim-1))
x2 = np.squeeze(y)
x3 = np.squeeze(y, axis=-1)
x4 = np.reshape(y, y.shape[:-1])
# ä¸Šè¿°å››ç§æ–¹æ³•çš„ç»“æœå®Œå…¨ä¸€è‡´
assert(np.all(x1==x2))
assert(np.all(x2==x3))
assert(np.all(x3==x4))
print(x4)
# è¾“å‡ºä¸ºï¼š
# [[ 0  1  2  3]
#  [ 4  5  6  7]
#  [ 8  9 10 11]]
```

## å°†å¤šç»´æ•°ç»„å‹ç¼©ä¸ºä¸€ç»´æ•°ç»„

å°†å¤šç»´æ•°ç»„å‹ç¼©ä¸ºä¸€ç»´æ•°ç»„ï¼Œå¯ä½¿ç”¨flattenæˆ–ravelä»¥åŠ[reshape](https://so.csdn.net/so/search?q=reshape&spm=1001.2101.3001.7020)æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
z1 = y.flatten()
z2 = y.ravel()
z3 = y.reshape(y.size)
# ä¸Šè¿°ä¸‰ç§æ–¹æ³•ç»“æœå®Œå…¨ä¸€è‡´
assert(np.all(z1==z2))
assert(np.all(z2==z3))
print(z3)
# è¾“å‡ºä¸ºï¼š
# [ 0  1  2  3  4  5  6  7  8  9 10 11]
```

## å°†å¤šç»´æ•°ç»„å‹ç¼©ä¸ºäºŒç»´æ•°ç»„ï¼Œ0è½´ä¿æŒä¸å˜

åœ¨æ·±åº¦å­¦ä¹ æˆ–å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæœ‰æ—¶éœ€è¦å°†shapeä¸º(batches, d1, d2, d3,...)çš„å¤šç»´æ•°ç»„è½¬åŒ–ä¸ºshapeä¸ºï¼ˆbatches, d1*d2*d3...ï¼‰çš„æ•°ç»„ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨reshapeè¿›è¡Œè½¬åŒ–ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
#ç”Ÿæˆå¤šç»´æ•°æ®
d0 = np.expand_dims(x, axis=0)
d1 = np.repeat(d0, 3, axis=0)
print(d1)
# è¾“å‡ºä¸º
# [[[ 0  1  2  3]
#   [ 4  5  6  7]
#   [ 8  9 10 11]]
 
#  [[ 0  1  2  3]
#   [ 4  5  6  7]
#   [ 8  9 10 11]]
 
#  [[ 0  1  2  3]
#   [ 4  5  6  7]
#   [ 8  9 10 11]]]
 
 
#è½¬åŒ–ä¸ºäºŒç»´æ•°ç»„
d2 = np.reshape(d1, (d1.shape[0], d1[0].size))
print(d2)
# è¾“å‡ºä¸ºï¼š
# [[ 0  1  2  3  4  5  6  7  8  9 10 11]
#  [ 0  1  2  3  4  5  6  7  8  9 10 11]
#  [ 0  1  2  3  4  5  6  7  8  9 10 11]]
```

